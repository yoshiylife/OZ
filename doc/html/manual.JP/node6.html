<!DOCTYPE HTML PUBLIC "-//W3O//DTD W3 HTML 2.0//EN">
<!Converted with LaTeX2HTML 95 (Thu Jan 19 1995) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds >
<!Actually with its Japanized version JLaTeX2HTML 95 (Wed Mar 1 1995) by Masahiro Kitagawa (kitagawa@ee.es.osaka-u.ac.jp), Osaka University >
<HEAD>
<TITLE>2.2 イメージの作り方</TITLE>
</HEAD>
<BODY>
<meta name="description" value="2.2 イメージの作り方">
<meta name="keywords" value="main">
<meta name="resource-type" value="document">
<meta name="distribution" value="global">
<P>
 <H2><A NAME=SECTION00032000000000000000>2.2 イメージの作り方</A></H2>
<P>
<H3><A NAME=SECTION00032100000000000000>2.2.1 概要</A></H3>
<P>
この利用マニュアルは、 OZ++ の分散オブジェクト管理システムのオブジェクト
イメージを作成するツール newimage の利用方法を説明するものです。
<P>
OZ++ システムでは、エグゼキュータ上でオブジェクトを動作させることによって
計算処理が進みます。
ユーザオブジェクト<A NAME=tex2html3 HREF="footnode.html#687">※</A>
を実行するためには分散オブジェクト管理システムのオブジェクト 
(以下、管理オブジェクトと言う) が必要で、エグゼキュータを生
成する際にはこれらのオブジェクトを作成する必要があります。
これらのオブジェクトの生成を行うツールが、以下で述べる newimage です。
<P>
以下では newimage の使い方を述べますが、サイトのどこにどのようなオブジェク
トを配置すべきかに関しては、「管理オブジェクトの構成」に記述してあります。
<P>
<H3><A NAME=SECTION00032200000000000000>2.2.2 機能説明</A></H3>
<P>
オブジェクトイメージ定義ファイル <BR>
<P>
OZ++ では、オブジェクトに大きく分けて二種類あります。ひとつは、グローバルに有
効なオブジェクト ID を持ち、他のエグゼキュータからでもメソッド起動され得る、
グローバルオブジェクトです。グローバルオブジェクトでないオブジェクトはローカ
ルオブジェクトと呼ばれます。ローカルオブジェクトはどれかのグローバルオブジェ
クトに従属して存在しています。他のグローバルオブジェクトに属しているローカル
オブジェクトに直接アクセスすることはできません。
<P>
各エグゼキュータ上では一般に複数のグローバルオブジェクトが、それに従属してい
るローカルオブジェクトとともに動作しています。グローバルオブジェクトは、永続
化することができます。永続化されているグローバルオブジェクトを `永続オブジェ
クト' と呼びます。永続オブジェクトは、そのグローバルオブジェクトに従属するロー
カルオブジェクトとともにファイルに格納されます。ファイルに格納されるオブジェ
クトの表現を `オブジェクトイメージ' と呼び、オブジェクトイメージを納めたファ
イルを `オブジェクトイメージファイル' と呼びます。オブジェクトイメージファイ
ルはディレクトリ `$OZROOT/images' の下に、下記のようなディレクトリ構造で保存
されています。
<PRE>        $OZROOT/images/000101/objects/000001
                                      000002
                                      000003
                       000102/objects/000001
                                      000002
                                        :
</PRE>
$OZROOT/images の直下には、エグゼキュータ ID の、サイト内における
エグゼキュータ番号に相当する部分を 16 進数で表現した名前のディレクトリが
あります。
その中のディレクトリ「objects」の下に、そのエグゼキュータ上にある
グローバルオブジェクトのオブジェクトイメージファイルが格納されており、
そのオブジェクト ID の、そのエグゼキュータ上での番号を表す部分を 16 進数で
表現した名前がついています。
<P>
例えば、サイト ID を 0001 とすれば、上の例では、ふたつのエグゼキュータ
<PRE>        0001 000101 000000
        0001 000102 000000
</PRE>
があり、それぞれオブジェクト
<PRE>        0001 000101 000001
        0001 000101 000002
        0001 000101 000003
</PRE>
と
<PRE>        0001 000102 000001
        0001 000102 000002
</PRE>
を保持していることを意味しています。
<P>
<H3><A NAME=SECTION00032300000000000000>2.2.3 使い方</A></H3>
<P>
<b> [操作の概要]</b>
<P>
newimage はオブジェクトイメージを新規に作成する対話的なツールです。
起動するには、 nfe <A NAME=tex2html4 HREF="footnode.html#694">※</A> から、
<blockquote> nfe<b>&gt;</b> newimage
</blockquote>
<P>
とタイプします。起動後、
newimage は、以下の順に対話的に設定条件を確認していきます。
<P>
<UL><LI> クラスオブジェクトの設定
<LI> ネームディレクトリの設定
<LI> ランチャの設定
<LI> カタログの設定
<LI> オブジェクトマネージャの設定
</UL>
<P>
そして、最後にオブジェクトイメージコンパイラ (oic) を起動して、オブジェクトイ
メージファイルを作成します。以下、順を追って操作の詳細を説明していきます。
<P>
<b> [操作の詳細]</b>
<P>
  newimage の起動時 <BR>
<P>
起動するには、 nfe から以下のようにタイプします。
<blockquote> nfe<b>&gt;</b> newimage
</blockquote>
newimage の起動直後に次のようなエラーメッセージが出力される場合があります。
<blockquote> ・template directory ($OZROOT/lib/image-template) doesn't exist.
</blockquote>
これは、あるべきテンプレートディレクトリが見当たらないという意味です。 
$OZROOT のところには、 OZROOTとして設定されているパスが表示されます。
この場合、 OZ++ システムのインストールが正常に行われなかった可能性がありま
すので、システム全体の再インストールをして下さい。
<P>
 設定方法の選択 <BR>
<P>
多くのエグゼキュータでは、
何らかの管理オブジェクトを動作させることが必要です。 
newimage には、典型的な場合の設定がプリセットされており、
これに従う場合は、それらの中から設定を選択することができます 
(より詳細な説明は、「管理オブジェクトの構成」を参照して下さい) 。
<P>
newimage を起動すると、次のような画面が表示されます。
<PRE>        What kind of image do you want?
            1. Site master
            2. Station master
            3. Slave with a class object
            4. Slave without a class object
            5. Stand alone
            9. Fully customized
            0. Help
        ?
</PRE>
メニューの内、 1 から 5 は、標準的な設定を提供しています。
これらの意味については、
「管理オブジェクトの構成」を参照して下さい。 
9 を選択すると、すべてを個別に設定できます。
<P>
0 はヘルプで、標準的な設定に関する説明を見ることができます。
<P>
9 は、すべての設定を含んでいることから、まず 9 に関して説明を行います。
<P>
標準的な設定についてのそれぞれの説明は、後述することとします。
以下、メニュー9 を選択した場合の操作について説明します。
<P>
<OL><LI> クラスオブジェクトの設定
<P>
クラスオブジェクトの設定は、そのエグゼキュータに作成する場合と他のエグゼキュー
タのものを雇う場合とで異なります。
<P>
<OL><LI>  そのエグゼキュータにクラスオブジェクトを作成する場合<BR> 
この場合は、
<blockquote> Do you need a local class object for this executor (y/n) ?
</blockquote>
に y と答えて下さい。
すると、作成するクラスオブジェクトの種類を尋ねてきます。
<blockquote> What kind of class do you need (1 .. normal, 2 .. with monitor) [1] ?
</blockquote>
with monitor というのは、クラス配送モニタを出力するタイプのクラスオブジェクト
です。どちらでも好きな方を指定して下さい。
<P>
続いて、そのクラスがブートクラスを管理するかどうかを尋ねてきます。
<blockquote> Does it manage boot-classes (y/n) ? 
</blockquote>
<P>
ブートクラスとは、開発環境をセットアップして自力でクラスをコンパイルして
自由に追加できるようになるまでに必要なクラスのことです 
(「管理オブジェクトの構成」を参照して下さい)。
<P>
続いて、クラスオブジェクトをネームディレクトリに登録するかどうかを尋ねてき
ます。
<blockquote> Do you want to name the class object (y/n) ?
</blockquote>
自由な名前をいくつでもつけて下さい。
<P>
クラスオブジェクトは、コンパイラフロントエンドなどから利用したり、 次節で
述べるように他のエグゼキュータから雇われたりしますが、その際にはここでつけた
名前で参照されます。名前を忘れないようにしてください。
<P>
複数のクラスオブジェクトに同じ名前を付けることはできません。
<P>
<LI> 他のエグゼキュータのクラスオブジェクトを雇う<BR> 
そのエグゼキュータにクラスオブジェクトを置かないことも可能です。しかし、その
エグゼキュータ上のオブジェクトが動作するためには、そのエグゼキュータにクラス
を供給するクラスオブジェクトが少なくともひとつは必要です。
<blockquote> Do you need a local class object for this executor (y/n) ?
</blockquote>
に n と答えると、クラスオブジェクトを置かないエグゼキュータを作ることができ
ます。
<P>
この場合、外部のクラスオブジェクトをいくつ雇うか尋ねてきます。
<blockquote> How many remote class objects do you employee ?
</blockquote>
適切な数を答えて、
<blockquote> What is the name (i)
</blockquote>
(i には数字が入ります) に、雇うクラスオブジェクトの名前を入力していって下さい。
<P>
ただし、ここで雇い入れることができるクラスオブジェクトは、そのエグゼキュー
タと同じ OZROOT を共有していなければなりません。たいていは、同じステーション
上にあるエグゼキュータでしょう。あるいは、 NFS などの機構によって、 OZROOT を
共有している場合もあるかもしれません。そうでないクラスオブジェクトを指定して
も newimage にはチェックできません。しかもそのエグゼキュータは動作しませんの
で、特に注意が必要です。
</OL>
<P>
 <LI> ネームディレクトリの設定<BR> 
このリリースでは、 
newimage を使ってローカルなネームディレクトリを作ったり
ネームディレクトリを複製したりという設定はできませんので、
既にどこかにネームディレクトリがあるドメインでは、
ふたつめのネームディレクトリを作っても使えません。
したがって普通は、
ドメインの中心的なエグゼキュータを作成しようとしているときだけ、
<blockquote> Do you need a local name directory (y/n) ?
</blockquote>
に y と答えて下さい。
既にネームディレクトリをどこかに持っている場合は n と答えて下さい。
<P>
<OL><LI> ネームディレクトリを作るとき<BR> 
ネームディレクトリを作る場合は以下の設定を行います。
<blockquote> Do you want to preload the name directory (y/n) ?
</blockquote>
この質問に対してはy/nのどちらに答えても構いません。
<P>
次に、そのネームディレクトリが管理するドメインの名前を尋ねられます。
<blockquote> What domain does the name directory manage ?
</blockquote>
何か文字列を入力して下さい。 
DNS のドメイン名 (ipa.go.jp など) を使うのが、紛れがなくてよいでしょう。
<P>
 <LI> ネームディレクトリを作らないとき<BR> 
ネームディレクトリを作らない場合は、
<blockquote> You can set an object ID as the name directory for this executor.
        Or, at the first execution of this executor, the name directory
        is searched by broadcasting.
<P>
        Do you set an object ID as the name directory (y/n) ?
</blockquote>
と聞かれます。どちらを答えても構いません。
<P>
もしも y を答えたなら、続いて
<blockquote> What is the object ID ?
</blockquote>
と質問されますので、ネームディレクトリのオブジェクト ID を入力します。 
newimage で作成したネームディレクトリのオブジェクト ID は、必ず
<PRE>    サイト ID (4ケタ) + エグゼキュータ番号 (6ケタ) + 000003
</PRE>
になっています。例えば、サイト ID 1、エグゼキュータ番号 0x101 のエグゼ
キュータのネームディレクトリのオブジェクト ID は、
<PRE>        0001000101000003
</PRE>
です。
<P>
さもなければ、 0000000000000000 を答えることもできます。
これは n を答えるのと同じ結果になります。
すなわち、このエグゼキュータの起動時に、サイト内の全ニュクリアスに対して、
ネームディレクトリを探すためのブロードキャスト通信が送信されます。
</OL>
<P>
<LI> ランチャの設定
<blockquote> Do you need a Launcher (y/n) ?
</blockquote>
および
<blockquote> Do you want to preload the launcher (y/n) ?
</blockquote>
にはy/nどちらに答えても構いません。ただし、ランチャのないエグゼキュータからは
アプリケーションを起動できませんので、プリロードすることを推奨します。
<P>
<LI> カタログの設定<BR> 
そのエグゼキュータにカタログを作成するのでしたら、
<blockquote> Do you need a local catalog (y/n) ?
</blockquote>
に y と答えて下さい。
<P>
`:catalog' という名前で参照されるカタログは、ドメインにひとつしか作れません。
このリリースでは、 
newimage を使ってカタログを分散配置したり複製したりという
設定はできませんので、
既にどこかにカタログがあるドメインでは、
ふたつめのカタログを作っても使えません。
したがって普通は、
そのドメインの中心的なエグゼキュータにだけカタログを作れば十分です。
<P>
カタログを作ったのなら、
<blockquote> Do you want to preload the catalog (y/n) ?
</blockquote>
には y を答えて下さい。
<P>
そのカタログに名前をつける場合は、
<blockquote> Do you want to name the school directory (y/n) ?
</blockquote>
に y と答えます。
<P>
ワークベンチやランチャから参照されるカタログは 
`:catalog' という名前のものですので、
普通は y を答えて `:catalog' という名前をつけます。
<P>
<LI> オブジェクトマネージャの設定<BR> 
最初にオーナ名を入力して下さい。
<blockquote> Who are you [nnnn] ?
</blockquote>
環境変数 $USER か $LOGNAME が設定されていれば、
その内容が nnnn に表示されているはずです。
<P>
続いて、
スタンドアローン用のオブジェクトマネージャにするかどうかを聞いてきます。
<blockquote> Do you make a stand alone object manager (y/n) ?
</blockquote>
スタンドアローン用のオブジェクトマネージャは、
動作にネームディレクトリなどの他の分散オブジェクト管理系のオブジェクトを
必要とせず、アプリケーションのオブジェクトをひとつだけ生成して
動作させることができます。
<P>
次の質問は、スタンドアローン用のオブジェクトマネージャを作った場合だけ
表示され、そうでない場合はスキップされます。
<blockquote> Do you refer a class directory of another executor (y/n) ?
</blockquote>
スタンドアローン用のオブジェクトマネージャは、他のエグゼキュータのクラスディレ
クトリを参照して動作することができ、そうすることで、クラスオブジェクトを作った
り雇ったりしないことが可能になります。詳細は、 -r オプションの説明で述べます。
<P>
続いて、
ブート時のコンフィギュレーションテーブルに対する追加/変更があるかどうかを
質問されます。
<blockquote> Do you make changes on the boot time configuration table (y/n) ?
</blockquote>
ここで y と答えると、コンフィギュレーションファイルの所在を質問されます。
<blockquote> What is the file name ?
</blockquote>
コンフィギュレーションファイル名を入力して下さい。
詳細は -a オプションの説明で述べます。
<P>
次に、デーモンプロセスの数を設定します。
<blockquote> Do you want to change the default number of fault daemons [2/2/0/2/1/3/2] (y/n) ?
</blockquote>
プロセスは資源を消費するので、一般的に言って数は少ない方がよいです。
デフォルトの設定でも特に問題はありません。
参考までに、ここで設定可能なデーモンプロセスの種類と、デフォルトの数、
および役割を述べておきます。
<UL><LI> BroadcastReceiver [2]
<P>
ブロードキャストを受信します。
<P>
<LI> CodeFaultDaemon [2]
<P>
エグゼキュータがあるクラスの実行可能コードを必要としたときに、
必要なクラスの ID をオブジェクトマネージャに伝えます。
<P>
<LI> LayoutFaultDaemon [0]
<P>
エグゼキュータがあるクラスのレイアウト情報を必要としたときに、
必要なクラスの ID をオブジェクトマネージャに伝えます。
ただし、このリリースには Sun OS 4.1.3 用のセットしか含まれていませんので、
実際にこのデーモンプロセスが起動されることはありません。
<P>
<LI> ClassRequestDaemon [2]
<P>
エグゼキュータがあるクラスの実行時クラス情報を必要としたときに、
必要なクラスの ID をオブジェクトマネージャに伝えます。
<P>
<LI> ObjectFaultDaemon [1]
<P>
まだ起動されていないグローバルオブジェクトのメソッドが起動されたときに、
ど のグローバルオブジェクトのメソッドが起動されたのかを
オブジェクトマネージャに伝えます。
<P>
<LI> ConfigurationDaemon [3]
<P>
エグゼキュータは、インスタンスの生成の際に必ずコンフィギュレーション情報を
必要としますが、それをオブジェクトマネージャに伝えるためのデーモンです。
数あるデーモンプロセスの中でも最も頻繁に動作します。
<P>
<LI> DebuggerClassRequestDaemon [2]
<P>
デバッガがあるクラスの情報を必要としたときに、必要なクラスの ID をオブジェ
クトマネージャに伝えます。
</UL>
<P>
最後に、
<blockquote> Do you want to name the object manager (y/n) ?
</blockquote>
と聞かれます。好きな名前をいくつでもつけて下さい。
<P>
<LI> 起動時のオプション
<P>
newimage は、以下のオプションを認識します。
<P>
<DL ><DT>-n
<DD> このエグゼキュータに、 nfe が認識可能な名前をつけます。
<DT>-c
<DD> このエグゼキュータにコメントを付記します。
          コメントは、 nfe の exidlist コマンドなどを実行すれば表示できます。
<DT>-g
<DD> クラスオブジェクトを、クラス配送モニタなしに設定します。
<DT>-d domain-name
<DD> <BR> 
          このエグゼキュータが属すべきドメイン名を domain-name に設定します。
<DT>-u user-name
<DD> <BR> 
          このエグゼキュータのオーナ名を user-name に設定します。
<DT>-k configuration-name
<DD> <BR> 
          標準のコンフィギュレーションを使用します。
          configuration-name は、次のいずれかです。<BR> 
<blockquote> site-master または 1<BR> 
        station-master または 2<BR> 
        slave-with-class または 3<BR> 
        slave-without-class または 4<BR> 
        stand-alone または 5<BR> 
</blockquote>
<P>
<DT>-o image-directory
<DD> <BR> 
          オブジェクトイメージディレクトリを、 $OZROOT/images/<b>&lt;</b>EX-ID<b>&gt;</b> 
          ではなく、 image-directory/<b>&lt;</b>EX-ID<b>&gt;</b> に作り、
          $OZROOT/images/<b>&lt;</b>EX-ID<b>&gt;</b> から image-directory/<b>&lt;</b>EX-ID<b>&gt;</b> に
          シンボリックリンクを張ります。
<P>
<DT>-a configuration-file-name
<DD> <BR> 
          オブジェクトマネージャにブート時に有効なコンフィギュレーションを
          教えるための設定ファイル (コンフィギュレーションファイル) を
          指定します。インスタンスを生成する際、エグゼキュータは、
          オブジェクトマネージャに対し、パブリックパートの ID を指定して、
          使用すべきコンフィギュアドクラスの ID を問い合わせてきます。
          オブジェクトマネージャは通常これをクラスオブジェクトに問い合わせて
          解決し、エグゼキュータに回答します。しかし、
          オブジェクトマネージャは、クラスオブジェクトがいない状況でも
          動作しなければならない場合があります。すなわち、エグゼキュータの
          ブートの際と、スタンドアローンでの動作時です。
          この状態でインスタンスを生成しなければならない場合、
          オブジェクトマネージャは、内部の
          ブートコンフィギュレーションテーブルの設定にしたがって
          コンフィギュアドクラス ID を回答します。
          通常は、ブートコンフィギュレーションは、オブジェクトマネージャと
          クラスオブジェクトのブートに必要なクラスについて、インストール時に
          コンパイルされたバージョンが利用されるように設定されています。
          -a オプションは、ブートコンフィギュレーションテーブルの内容を
          変更したり、追加したりするために用います。
          コンフィギュレーションファイルの書式は以下の通りです。
<P>
<PRE>    &lt;file&gt; ::= &lt;record&gt;*
    &lt;record&gt; ::= CLASS-NAME &lt;public-part&gt; &lt;configured-class&gt; '\n'
    &lt;public-part&gt; ::= OID
    &lt;configured-class&gt; ::= OID
</PRE>
          ここで、 CLASS-NAME は OZ++ 言語のクラス名として有効な文字列で、
          コンフィギュレーションを変更/追加しようとするクラスの名前を表します。
          OID は、 16 文字の 16 進数です。各語の間には、
          任意に空白または TAB が挿入されていて構いません。
          ただし、改行は '\n'
 で指定された位置以外には
          挿入できません。
          空行および `#' で始まる行はコメントと解釈されます。
<P>
<DT>-r executor-ID
<DD> <BR> 
          スタンドアローンでだけ有効なオプションです。スタンドアローンでは、
          そのエグゼキュータの動作に必要なすべてのクラスを持った
          クラスオブジェクトが、同じ OZROOT 上に存在する場合、
          そのエグゼキュータのクラスディレクトリを直接参照することによって、
          クラスオブジェクトに対する問い合わせをすることなしに
          動作可能となります。 -r オプションは、このクラスディレクトリを
          提供するエグゼキュータを指定します。
<DT>-p
<DD> newimage が用いる中間的な生成物を、削除しないようにします。
<P>
 </DL>
<P>

これらのオプションが適切に設定されているならば、
対応する設定手順は省略されます。
<P>
<LI> 標準の設定
<P>
以下では、 newimage で提供されている四種類の標準の設定について説明します。
「管理オブジェクトの構成」も合わせて参照して下さい。
<P>
<OL><LI> サイトマスター
<P>
ネームディレクトリやカタログは、最初は各ドメインにひとつあれば十分です。サイ
トマスターは、これらを保持しているエグゼキュータで、そのドメインで中心的な役
割を果たします。そのドメインが動作するのにサイトマスター (または、同等の機能
を持つエグゼキュータ) は必須です。
<P>
サイトマスターは、以下のオブジェクトを持っています。
<UL><LI> オブジェクトマネージャ <BR> 
      :object-managers:site-master という名前がつきます。
      デーモンの数はデフォルトで設定されます。
<P>
<LI> クラスオブジェクト <BR> 
      :classes:site-master という名前がつきます。
      ブート用のクラスを管理し、プリロードされます。
      クラス配送モニタつきです。
      他のエグゼキュータ上のクラスオブジェクトを雇うことはしません。
<P>
<LI> ネームディレクトリ <BR> 
      プリロードはされませんが、オブジェクトマネージャは起動直後にネームディ
      レクトリを探してメソッド起動しますので、そのときにロードされます。
<P>
<LI> カタログ <BR> 
      :catalog という名前がつき、プリロードされます。
<P>
<LI> ランチャ <BR> 
      プリロードされます。
</UL>
<P>
加えて、以下の設定に関するオプションを指定することができます。オプションが
指定されていなければ、対話的に指定することができます。
<P>
<UL><LI> コンフィギュレーションファイル (-a オプション)
<LI> ドメイン名 (-d オプション)
<LI> オーナ名 (-u オプション)
</UL>
<P>
<LI> ステーションマスター
<P>
NFS などで OZROOT を共有しているのでない限り、ステーションには、そのステーショ
ン上のエグゼキュータにクラスを供給するクラスオブジェクトが必要です。ステーショ
ンマスターは、ブートクラスを管理するクラスを保持しているエグゼキュータで、そ
のステーションと、 OZROOT を共有している他のステーション上のエグゼキュータに
クラスを供給できます。ステーションマスターは、それらのエグゼキュータが動作し
ている限りは停止させてはいけません。
　ステーションマスターは以下のオブジェクトを持っています。
<P>
<UL><LI> オブジェクトマネージャ <BR> 
      :object-managers:<b>&lt;</b>EXID<b>&gt;</b> という名前がつきます。
      <b>&lt;</b>EXID<b>&gt;</b> には、エグゼキュータ ID (16 桁の 16 進数) のうち、
      サイト内でのエグゼキュータ番号にあたる部分 (5 桁めから 10 桁めまで) の 
      6 桁が入ります。
      デーモンの数はデフォルトで設定されます。
<P>
<LI> クラスオブジェクト <BR> 
      :classes:<b>&lt;</b>EXID<b>&gt;</b> という名前がつきます。
      ブート用のクラスを管理し、プリロードされます。
      クラス配送モニタつきです。
      他のエグゼキュータ上のクラスオブジェクトを雇うことはしません。
<P>
<LI> ランチャ <BR> 
      プリロードされます。
</UL>
<P>
ネームディレクトリとカタログはありません。
加えて、以下の設定に関するオプションを指定することができます。オプションが
指定されていなければ、対話的に指定することができます。
<P>
<UL><LI> コンフィギュレーションファイル (-a オプション)
<LI> ドメイン名 (-d オプション)
<LI> オーナ名 (-u オプション)
</UL>
<P>
<LI> クラスオブジェクトつきスレーブ
<P>
適切なクラスオブジェクトからクラスの供給を受けられるエグゼキュータでは、それ
自身がクラスオブジェクトを保持している必要はないのですが、効率上の理由からク
ラスオブジェクトを置いておきたいことは多いでしょう。クラスオブジェクトつきス
レーブは、ブートクラスを管理しないクラスオブジェクトを保持しているエグゼキュー
タです。 クラスオブジェクトつきスレーブは、その保持しているクラスオブジェクト
がブートクラスを管理しないという点を除いて、ステーションマスターと同じです。
<P>
<LI> クラスオブジェクトなしスレーブ
<P>
クラスオブジェクトを持たずに、他のエグゼキュータ上のクラスオブジェクトからク
ラスを供給してもらうエグゼキュータです。クラスオブジェクトを保持しない点を除
いて、クラスオブジェクトつきスレーブと同じですが、加えて、他のエグゼキュータ
上のクラスオブジェクトを雇うことができます。どのクラスオブジェクトを雇うかは、
対話的に設定できます。
<P>
<LI> スタンドアローン
<P>
それ単独で動作させることの可能なエグゼキュータです。すなわち、サイトマスター
やステーションマスターが動作していることを必須の条件としません。ただし、アプ
リケーション自身が、ネームディレクトリやカタログに対する操作を要求している場
合は、それらが動作していなければなりません。クラスオブジェクトは、ある条件を
満たす場合に、不要となります。すなわち、実行時にはクラスファイルが必要ですの
で、同じ OZROOT 上に、実行時に必要となるすべてのクラスを保持しているクラスオ
ブジェクトが存在する場合にのみ、そのクラスディレクトリを直接参照するように設
定することで、新たにクラスオブジェクトを生成したり、他のクラスオブジェクトを
雇ったりしなくてよくなります。条件を満たすエグゼキュータが存在しない場合は、
クラスオブジェクトを生成するか雇うかして、不足のクラスの配送を受けられるよう
にしなければなりません。
<P>
<UL><LI> オブジェクトマネージャ <BR> 
      スタンドアローン用のオブジェクトマネージャが生成されます。
      :object-managers:<b>&lt;</b>EXID<b>&gt;</b> という名前がつきます。
</UL>
<P>
その他のオブジェクトはありません。
<P>
加えて、以下の設定に関するオプションを指定することができます。オプションが
指定されていなければ、対話的に指定することができます。
<P>
<UL><LI> コンフィギュレーションファイル (-a オプション)
<LI> ドメイン名 (-d オプション)
<LI> オーナ名 (-u オプション)
</UL>
<P>
スタンドアローンエグゼキュータにはランチャがありませんが、代わりに、アプリ
ケーションのオブジェクトをひとつ生成して起動することができます。このオブジェ
クトは、グローバルオブジェクトとして生成されます。必ず Startable クラスのサブ
クラスであって、下記のパブリックメソッドを実装していなければなりません。
<blockquote> void Initialize(): global
</blockquote>
メソッド Initialize は、そのオブジェクトを生成するときに一度だけ呼ばれます。
通常のグローバルオブジェクト同様、 Initialize が呼ばれるときには Go は呼ばれ
ず、その後の起動時には Go が呼ばれて Initialize は呼ばれません。
<P>
スタンドアローン用のオブジェクトマネージャを起動すると、ダイアログウィンド
ウが表示されます。このダイアログウィンドウを通して、アプリケーションオブジェ
クトの起動に関する設定が行われます。
<P>
最初に、コンフィギュレーションファイルを質問してきます。
<blockquote> Configuration File [none]:
</blockquote>
newimage の際に指定したコンフィギュレーションファイルで十分であれば、単にリター
ンします。さもなければ追加のコンフィギュレーションファイル名を入力して下さい。
入力されたファイルが存在しない場合は、再度質問してきます。
<P>
続いて、生成するアプリケーションオブジェクトのコンフィギュアドクラス ID が
質問されます。
<blockquote> Configured Class ID:
</blockquote>
16 文字の 16 進数を入力して下さい。それ以外のものを入力すると、再度質問してき
ます。正しく入力されると、そのクラスのオブジェクトが生成され、メソッド 
Initialize が呼び出されます。生成したオブジェクトが永続化した場合、次回以降の
起動では、コンフィギュアドクラス ID の問い合わせは行われず、そのオブジェクト
が起動されます。そのオブジェクトが削除されると、その次の起動の際には、再びコ
ンフィギュアドクラス ID が質問されます。
<P>
これでアプリケーションオブジェクトが動作し始めますが、コンフィギュレーショ
ンファイルに不足があって、動作中に生じたインスタンス生成ができない場合は、ダ
イアログウィンドウに次のように表示されます。
<blockquote> Configured Class ID for xxxxxxxxxxxxxxxx:
</blockquote>
xxxxxxxxxxxxxxxx には、生成するクラスのパブリックバージョン ID が表示されてい
ますので、対応するコンフィギュアドクラス ID を入力して下さい。
</OL>
<P>
<LI> oic のエラーメッセージ
<P>
インストールや、他の何かの設定に異常があった場合、オブジェクトイメージコンパ
イラ oic がエラーメッセージを出力することがあります。こうなるとユーザにできる
ことはあまり多くないのですが、次の確認をするとよい場合もあります。
<P>
<UL><LI> sb は正しく動作していますか?
<P>
コマンドラインから
<blockquote> % sb Class 0
</blockquote>
と投入して、 16 ケタの 16 進数が表示されることを確認して下さい。
<P>
これが正しく動作しない場合は、ブート処理系のスクールファイル 
$OZROOT/etc/boot-school が正しくインストールされていない疑いがあります。
インストールをやり直して、エラーメッセージを注意して見て下さい。
<P>
<LI> Makefile.oibuild は正しくインストールされていますか?
<P>
$OZROOT/lib/Makefile.oibuild が存在していて、サイズが 0 でないことを
確認して下さい。
</UL>
<P>
<LI> newimage の中断
<P>
newimage は、 SIGHUP, SIGINT, SIGTERM で停止した場合、
作業中のオブジェクトイメージファイルの入ったディレクトリ 
($OZROOT/images/<b>&lt;</b>executor-id<b>&gt;</b>) を抹消します。
何らかの理由でこれを残したまま newimage を中断させたい場合は、 
SIGQUIT (端末から ^\) で停止させて下さい。

</OL>
<P>
	<BR> <HR>
<P><ADDRESS>
Copyright 1994-1997 Information-technology Promotion Agency, Japan
</ADDRESS>
</BODY>
