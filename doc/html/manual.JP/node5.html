<!DOCTYPE HTML PUBLIC "-//W3O//DTD W3 HTML 2.0//EN">
<!Converted with LaTeX2HTML 95 (Thu Jan 19 1995) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds >
<!Actually with its Japanized version JLaTeX2HTML 95 (Wed Mar 1 1995) by Masahiro Kitagawa (kitagawa@ee.es.osaka-u.ac.jp), Osaka University >
<HEAD>
<TITLE>2.1 OZ++の分散オブジェクトの構成</TITLE>
</HEAD>
<BODY>
<meta name="description" value="2.1 OZ++の分散オブジェクトの構成">
<meta name="keywords" value="main">
<meta name="resource-type" value="document">
<meta name="distribution" value="global">
<P>
 <H2><A NAME=SECTION00031000000000000000>2.1 OZ++の分散オブジェクトの構成</A></H2>
<P>
<H3><A NAME=SECTION00031100000000000000>2.1.1 概要</A></H3>
<P>
この文書は、 OZ++ を実際に利用するにあたって、あなたのサイトのどのマシンに
どんな役割を割り当て、どのように設定すればよいかのガイドラインを示すものです。
<P>
OZ++ システムは、エグゼキュータと呼ばれる実行系の上でオブジェクトを動作さ
せることによって計算が進みます。エグゼキュータは単体では動作できず、各マシン
上に存在するエグゼキュータを管理し、互いに通信できるための基本機能を提供して
いるニュクリアスを必要とします。ニュクリアスには、サイトの中で果たす役割に応
じていくつかの種類があり、適切な種類のニュクリアスを適切に配置する必要があり
ます。一方オブジェクトにも、ユーザオブジェクトの他に、ユーザオブジェクトの支
援を行う管理オブジェクトを、サイトの中の適切な位置に配置する必要があります。
<P>
この文書では、第一版リリース 5 のシステムにおいて、ニュクリアスや管理オブ
ジェクトをどのように配置したらよいかが示されます。
<P>
<H3><A NAME=SECTION00031200000000000000>2.1.2 ニュクリアスの構成</A></H3>
<P>
OZ++ サイトの構成 <BR>
<P>
OZ++ の運用単位を OZ++ サイトと呼びます。
<P>
<UL><LI> サイト <BR> 
論理的にブロードキャスト可能な範囲をサイトと呼びます。ドメインが論理的な管
理単位を表しているのに対して、サイトはネットワークの物理的な構成に依存した
管理単位です。サイトは一つ以上のセグメントから構成されます。
<P>
<LI> セグメント <BR> 
物理的にブロードキャスト可能な範囲をセグメントと呼びます。セグメントは同一
の物理的なセグメントに属している一つ以上のステーションから成ります。
同じサイトに属すセグメント間でブロードキャストが届くように、各セグメントに
ハーフルータ・ニュクリアス(後述)を設けます。
論理的なブロードキャストとは、図<A HREF="node5.html#figoz_system">2.1--1</A> で示すように
ブロードキャストをハーフルータ・ニュクリアスが中継することにより、
セグメントを越えて届くことを言います。
<P>
<LI> ステーション <BR> 
一つの計算機です。各ステーション上には、必ず一つのニュクリアスと 0 個以上
のエグゼキュータが存在します。
</UL>
<P>
<A NAME=figoz_system>　</A>
<P>
<CENTER>
<TABLE>
<TR>
<TD>
<IMG ALIGN=BOTTOM ALT="bro.gif" SRC="figure/bro.gif">
</TD>
</TR>
<CAPTION ALIGN=BOTTOM><STRONG>図 2.1--1:</STRONG> 論理的ブロードキャスト伝搬イメージ</CAPTION>
</TABLE>
</CENTER>

<P>
ニュクリアスの配置 <BR>
<P>
ニュクリアスにはサイトの中で特別な役割を果たすものがあり、それらを適切に配
置する必要があります。
<P>
特別な役割を果たすニュクリアスの配置の設定はニュクリアス表に登録することで
行います。ニュクリアス表の設定は 「ニュクリアスの説明」 に
従って行って下さい。
<P>
<OL><LI> エグゼキュータ ID 管理ニュクリアス <BR> 
オブジェクトを搭載し、実行するエグゼキュータはサイト内でユニークな ID によ
って識別されます。この ID をエグゼキュータ ID と呼びます。エグゼキュータ ID 
管理ニュクリアスは、エグゼキュータの生成を集中管理するニュクリアスです。エグ
ゼキュータ ID 管理ニュクリアスから新しいエグゼキュータ ID をえることにより、
サイト内でユニークなエグゼキュータ ID を付与することを保証しています。
<P>
サイトには必ず一つだけエグゼキュータ ID 管理ニュクリアスを置いて下さい。こ
れは常に起動していることが必要なので、なるべく停止しないステーション上に起動
するのがよいでしょう。
<P>
<LI> ハーフルータ・ニュクリアス <BR> 
物理的なブロードキャストを中継するニュクリアスをハーフルータ・ニュクリアス
と呼びます(図 <A HREF="node5.html#figoz_system">2.1--1</A> 参照)。
<P>
サイトが複数のセグメントから構成されていた場合、各セグメントに一つずつハー
フルータ・ニュクリアスを置く必要があります。
</OL><H3><A NAME=SECTION00031300000000000000>2.1.3 管理オブジェクトの構成</A></H3>
<P>
OZ++ では、ユーザオブジェクトが動作するのに必要な機能を提供する一連の管理
オブジェクトが用意されており、これらを総称して分散オブジェクト管理システムと
呼んでいます。ユーザのオブジェクトが動作するためには、管理オブジェクトが適切
に配置されている必要があります。以下に、各管理オブジェクトの名称と概要を述べ
ます。
<P>
<UL><LI> オブジェクトマネージャ <BR> 
各エグゼキュータに必ず一つだけ必要です。
そのエグゼキュータ上のグローバルオブジェクトの状態を管理します。
グローバルオブジェクトの生成、停止、削除、一時停止などの機能を有します。
<P>
<LI> クラスオブジェクト <BR> 
おおむね、各ステーションに一つずつ必要です。
クラス (実行可能コードなど) を管理しています。
エグゼキュータは、その上で動作しているオブジェクトのクラスを必要とします。
クラスは、これを提供する役割を担っています。
<P>
クラスが、自身の管理していないクラスを要求されたら、その要求はネットワーク
を通じて委譲され、そのクラスを管理しているクラスオブジェクトからクラスの配送
を受けて、エグゼキュータに供給します。
<P>
<LI> ネームディレクトリ <BR> 
ドメイン (後述) に必ず一つだけ必要です。
グローバルオブジェクトに名前を与え、名前で参照する機能を提供します。
<P>
<LI> カタログ <BR> 
ドメインに必ず一つだけ必要です。
公開されているアプリケーションやクラスライブラリに名前をつけて保管します。
<P>
管理オブジェクトたちは、それ自身の動作のために他の管理オブジェクトを必要と
しますので、最初は管理オブジェクトを含んだオブジェクトイメージを作成しなくて
はなりません。管理オブジェクトのオブジェクトイメージを作成するツールとして 
newimage が提供されていますので、これを使って作成して下さい。使い方は 
「newimageの説明」 に書かれています。
</UL>
<P>
ドメイン <BR>
<P>
前項で述べた管理オブジェクトは、ネームディレクトリに次の名前で登録されてい
ます。
<P>
<CENTER>
<TABLE BORDER>
<TR>
<TD>クラスオブジェクト</TD> <TD></TD> <TD>":classes:xxxxxx"</TD>
</TR>
<TR>
<TD>ネームディレクトリ</TD> <TD></TD> <TD>":name"</TD>
</TR>
<TR>
<TD>カタログ</TD>           <TD></TD> <TD>":catalog"</TD>
</TR>
</TABLE>
</CENTER>

xxxxxx には、 newimage の際に特に指定されない限り、そのクラスオブジェクトが
いるエグゼキュータの ID の順序番号部分 6 ケタが入ります。エグゼキュータ ID 
が 0001001402000000 だとすれば、 001402 です。
このように、一つのネームディレクトリが作るオブジェクトの名前空間をドメイン
と呼びます。前項で述べた、ネームディレクトリやカタログがドメインに一つだけ必
要だという意味は、 &quot;:name&quot; や &quot;:catalog&quot; という名前に対応するオブジェクトが
あって、それぞれネームディレクトリとカタログの役割を果たさなければならないと
いう意味です。
<P>
ドメインは各サイトにいくつ作っても構いませんが、
ネームディレクトリやカタログは、各ドメインにひとつずつ必要です。
<P>
管理オブジェクトの特徴 <BR>
<P>
各管理オブジェクトを配置するにあたって、それぞれの
オブジェクトの特徴を示します。
<P>
<OL><LI>  オブジェクトマネージャ <BR> 
各エグゼキュータに必ず一つだけ作って下さい。
<P>
<LI> クラスオブジェクト <BR> 
クラスオブジェクトは、自身がいるエグゼキュータにクラスを提供することができ
ますが、同様に、 OZROOT を共有している他のエグゼキュータにも、クラスを提供で
きます。したがって、各 OZROOT ごとに、最低一つのクラスオブジェクトが動作して
いれば、それら全体を動かすことが可能です。通常は OZROOT は各ステーションごと
に作られるでしょうから、クラスオブジェクトも各ステーションごとに一つ必要とい
うことです。 NFS などによって OZROOT を共有している場合は、それらのステーショ
ン群の中に最低一つあればよいです。
<P>
クラスオブジェクトのいない OZROOT は動きませんので、同時に起動されない可能
性のあるエグゼキュータたちは、それぞれ別のクラスオブジェクトを持つ必要があり
ます。あるいは、各 OZROOT に対して、いつも起動しているエグゼキュータを一つ用
意して、そこにクラスオブジェクトを置くのもいいでしょう。
<P>
<UL><LI> プリロードクラスとブートクラス <BR> 
オブジェクトマネージャとクラスオブジェクトは、仮にそのエグゼキュータにクラ
スを供給するクラスオブジェクトがなかったとしても動作できなくてはなりません。
このため、これらを動作させるのに必要なクラスは、特別に“プリロードクラス”と
して指定されており、クラスオブジェクトがなくても適切に供給されるようになって
います。
<P>
しかし、ドメインを動作させるのに必要なネームディレクトリやカタログ、および、
アプリケーションの起動に必要なランチャ (「ランチャの説明」を参照して下さい) 
などを動かすためのクラスがなくては、事実上ユーザオブジェクトを動かすことはで
きません。これらの基本的なオブジェクトたちのために必要なクラスは、ブートクラ
スとして提供されています。プリロードクラスは、ブートクラスの一部です。クラス
オブジェクトがブートクラスを管理するかどうかは、 newimage でクラスオブジェク
トを作成する際に指定できます。
<P>
プリロードクラスでないブートクラスは、プリロードクラスとは異なり、クラスオ
ブジェクトによって適切に管理されることによって初めてエグゼキュータへの供給が
可能となります。
<P>
では、ブートクラスを管理しないクラスオブジェクトは存在価値がないのかという
と、そうではありません。クラスオブジェクトは、自身が管理していないクラスにつ
いてはネットワーク上の他のクラスオブジェクトから配送を受けることができますが、
この動作はプリロードクラスだけで実行できます。したがって、ブートクラスを管理
しないクラスオブジェクトを作成して、次々と必要なクラスの配送を受けながらエグ
ゼキュータにクラスを供給することが可能です 
(もちろんその場合、ネットワーク上のどこかにはブートクラスを
管理するクラスオブジェクトがいなくてはいけません)。
</UL>
<P>
<LI> ネームディレクトリ <BR> 
ドメインに必ず一つだけ作って下さい。
ネームディレクトリのないドメインは動作しませんので、あなたのサイトの中で、
常に稼働しているエグゼキュータ上に作って下さい。
<P>
<LI> カタログ <BR> 
ドメインに必ず一つだけ作って下さい。
カタログのいないドメインでは、 OZ++ プログラムを起動することが著しく困難に
なります。カタログは、ネームディレクトリと同じエグゼキュータ上に置いて、常に
動作させておくのがよいでしょう。
</OL>
<P>
管理オブジェクトの配置 <BR>
<P>
各管理オブジェクトをどのように配置したらよいか、ガイドラインを示します。
<P>
<OL><LI> サイトマスター<BR> 
まず、サイトマスター <A NAME=tex2html1 HREF="footnode.html#673">※</A>を作りましょう。なるべく停止しないステーションを一つ選
んで、なるべく停止しないエグゼキュータを作ります。ここには以下のものを置きま
す。
<UL><LI> オブジェクトマネージャ
<LI> クラスオブジェクト (ブートクラスを管理する)
<LI> ネームディレクトリ
<LI> カタログ
<LI> ランチャ
</UL>
newimage には、サイトマスターを作る簡単な手順が用意されていますので、それを
使えば、サイトマスターに必要なオブジェクトがそろったエグゼキュータを手軽に作
れます<A NAME=tex2html2 HREF="footnode.html#676">※</A>。
また、このリリースには、配布元で作成したサイトマスターが一つ含まれています。
このサイトマスターの上のクラスオブジェクトやカタログには、ブートクラス以外に
も、 OZ++ のユーザにとって有用な各種のクラスライブラリや、デモのために必要な
クラスが数多く登録されています。最初はこのサイトマスターを使ってみるのもよい
でしょう。
<P>
<LI> ステーションマスター<BR> 
一つのドメインに複数のサイトマスターは不要です。では、二台目以降のステーショ
ンには、どのようなエグゼキュータを作ればいいでしょうか? そこには以下のものを
置くようにしましょう。
<UL><LI> オブジェクトマネージャ
<LI> クラスオブジェクト (ブートクラスを管理する)
<LI> ランチャ
</UL>
こうすれば、ランチャの起動まではそのステーションだけでローカルにできますし、
他に必要なクラスがあれば、よそから配送を受けることもできます。このような構成
のエグゼキュータを、ステーションマスターと呼びます。一つのステーションに複数
のステーションマスターを作るのはかまいません。
<P>
newimage には、ステーションマスターを作る簡単な手順が用意されていますので、
それを使えば、上記のオブジェクトがそろったエグゼキュータを手軽に作れます。
<P>
<LI>  クラスオブジェクトつきスレーブ <BR> 
ステーションマスターの代わりに、ブートクラスを含むすべてのクラスを外部から
配送させるクラスオブジェクトを持ったエグゼキュータを作ることもできます。この
ようなエグゼキュータはクラスオブジェクトつきスレーブと呼ばれ、以下のオブジェ
クトを持っています。
<UL><LI> オブジェクトマネージャ
<LI> クラスオブジェクト (ブートクラスを管理しない)
<LI> ランチャ
</UL>
newimage には、クラスオブジェクトつきスレーブを作る簡単な手順が用意されて
いますので、それを使えば、上記のオブジェクトがそろったエグゼキュータを手軽に
作れます。
<P>
<LI> クラスオブジェクトなしスレーブ <BR> 
既にサイトマスターやステーションマスターを作ったステーション上に、二つ目以
降のエグゼキュータを作る場合は、どのようなオブジェクトを配置したらよいでしょ
うか? そこには以下のものを置くようにしましょう。
<UL><LI> オブジェクトマネージャ
<LI> ランチャ
</UL>
クラスオブジェクトは、既存のサイトマスターやステーションマスターのものを利用
します。
<P>
newimage には、クラスオブジェクトなしスレーブを作る簡単な手順が用意されて
いますので、それを使えば、上記のオブジェクトがそろったエグゼキュータを手軽に
作れます。
</OL>
<P>
管理オブジェクトの作り方 <BR>
<P>
管理オブジェクトは、 newimage というツールを利用して作成します。このツール
の使い方は、 「newimageの説明」に書かれています。
<P>
	<BR> <HR>
<P><ADDRESS>
Copyright 1994-1997 Information-technology Promotion Agency, Japan
</ADDRESS>
</BODY>
